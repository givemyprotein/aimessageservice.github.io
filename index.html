<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>전문 메시지 변환 서비스</title>
    <style>
        /* Formal and Clean Style CSS */
        :root {
            /* 주요 색상: 청색 계열 (신뢰), 흰색 (깔끔함), 회색 (전문성) */
            --color-primary: #1e3a8a; /* 짙은 파랑 (강조) */
            --color-secondary: #f9fafb; /* 배경 */
            --color-text: #374151; /* 본문 텍스트 */
            --color-border: #d1d5db; /* 구분선 및 경계 */
            --color-button-hover: #1c52a0;
        }

        body {
            font-family: 'Malgun Gothic', '맑은 고딕', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--color-secondary);
            color: var(--color-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            background-color: #ffffff;
            padding: 35px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 650px;
            border-top: 5px solid var(--color-primary); /* 전문적인 강조선 */
        }

        h1 {
            font-size: 1.8em;
            text-align: center;
            margin-bottom: 30px;
            color: var(--color-primary);
            font-weight: 600;
            border-bottom: 1px solid var(--color-border);
            padding-bottom: 10px;
        }

        /* 현재 접속자 수 표시 영역 */
        #status-area {
            text-align: right;
            font-size: 0.85em;
            color: #6b7280;
            margin-bottom: 20px;
        }

        /* 입력 폼 스타일 */
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--color-text);
            font-size: 0.95em;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 10px 12px;
            margin-bottom: 20px;
            border: 1px solid var(--color-border);
            border-radius: 5px;
            background-color: #ffffff;
            color: var(--color-text);
            font-size: 1em;
            box-sizing: border-box;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus,
        textarea:focus {
            border-color: var(--color-primary);
            outline: none;
        }

        textarea {
            min-height: 100px;
        }

        /* 버튼 스타일 */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: background-color 0.2s ease;
        }

        #register-btn {
            background-color: var(--color-primary);
            color: #ffffff;
            width: 100%;
            margin-top: 10px;
        }

        #register-btn:hover {
            background-color: var(--color-button-hover);
        }

        /* 상태/결과 영역 */
        #result-area {
            background-color: var(--color-secondary);
            border: 1px solid var(--color-border);
            padding: 20px;
            border-radius: 5px;
            margin-top: 30px;
            min-height: 80px;
            text-align: left;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        #result-area h3 {
            color: var(--color-primary);
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .result-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
        }

        .action-btn {
            background-color: #ffffff;
            border: 1px solid var(--color-border);
            color: var(--color-text);
            padding: 8px 15px;
            font-size: 0.9em;
        }

        .action-btn:hover {
            background-color: #e5e7eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI 전문 메시지 변환</h1>

        <div id="status-area">Ready: <span id="current-users">0</span></div>

        <form id="message-form">
            <div>
                <label for="topic-input">대화 주제</label>
                <input type="text" id="topic-input" placeholder="예: 고객 사과, 프로젝트 진행 보고, 회의 요청" required>
            </div>
            <div>
                <label for="content-textarea">대화 내용 (간결한 메모 형식)</label>
                <textarea id="content-textarea" placeholder="핵심 내용만 간결하게 입력해 주세요. (예: 납기 늦어짐. 내일 오전까지 완료할게요.)" required></textarea>
            </div>

            <button type="button" id="register-btn" class="btn" onclick="register()">변환</button>
        </form>

        <div id="result-area">
            <h3>AI 변환 결과</h3>
            <p id="ai-result">전문적이고 깔끔하게 다듬어진 메시지가 여기에 표시됩니다.</p>
            
            <div class="result-actions">
                <button class="btn action-btn" onclick="initializeForm()">초기화</button>
                <button class="btn action-btn" onclick="showOtherResponse()">다른 답변 보기</button>
            </div>
        </div>

    </div>

    <script>
        // [핵심 요구사항 - JavaScript]
        // 1. API 서버의 주소를 담는 상수 정의
        const SERVER_URL = "https://24ffa53f-5eae-42a6-9f8a-adae2891c0cf-00-2p69lx6982gt.pike.replit.dev:8000/"; // ★여기에 실제 서버 주소를 넣으십시오.

        /**
         * '변환' 버튼 클릭 시 실행되는 핵심 함수입니다.
         * 입력 데이터를 수집하여 정의된 SERVER_URL로 POST 요청을 보냅니다.
         */
        async function register() {
            // 1. DOM 요소 가져오기
            const topicInput = document.getElementById('topic-input');
            const contentTextarea = document.getElementById('content-textarea');
            const aiResultElement = document.getElementById('ai-result');
            const registerBtn = document.getElementById('register-btn');

            // 2. 입력 데이터 수집 및 유효성 검사
            const topic = topicInput.value.trim();
            const content = contentTextarea.value.trim();

            if (!topic || !content) {
                aiResultElement.textContent = "⚠️ 대화 주제와 내용을 모두 입력해 주십시오.";
                aiResultElement.style.color = '#d32f2f'; // 에러 색상
                return;
            }
            aiResultElement.style.color = 'var(--color-text)'; // 기본 색상으로 복원

            // 3. 버튼 비활성화 및 로딩 상태 표시
            registerBtn.disabled = true;
            registerBtn.textContent = '변환 중...';
            aiResultElement.textContent = "AI가 전문 메시지를 생성 중입니다. 잠시만 기다려 주십시오...";

            // 4. 서버에 전송할 JSON 데이터 구조
            const dataToSend = {
                topic: topic,
                content: content,
                requested_style: "formal_clean" // 요청 스타일 명시
            };

            // 5. fetch 함수를 이용한 POST 통신
            try {
                // SERVER_URL이 비어 있으면 통신은 실패하지만, 코드는 완벽해야 합니다.
                const response = await fetch(SERVER_URL, {
                    method: 'POST', // 통신 방식: POST
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    // 입력 필드의 데이터를 모아 JSON 형태로 서버에 전송
                    body: JSON.stringify(dataToSend) 
                });

                if (!response.ok) {
                    throw new Error(`HTTP Error! Status: ${response.status}`);
                }

                const result = await response.json();
                
                // 6. 통신 성공 후 결과 표시 (실제 응답 구조에 맞춰야 함)
                if (result && result.refined_message) {
                    aiResultElement.textContent = result.refined_message;
                } else {
                    aiResultElement.textContent = "서버로부터 유효한 결과를 받지 못했습니다.";
                }

            } catch (error) {
                // 7. 통신 실패 (SERVER_URL 미연결 시 실행)
                console.error("API 통신 실패 (백엔드 서버 미연결):", error);
                
                // 임시 테스트 메시지 출력
                aiResultElement.textContent = 
                    "⚠️ API 통신 오류가 발생했습니다. (SERVER_URL 확인 필요)\n\n" + 
                    "[테스트 메시지 - 깔끔하고 전문적인 스타일]:\n" + 
                    `'${topic}' 관련하여, 현재 입력하신 내용을 바탕으로 전문적으로 다듬은 결과는 다음과 같습니다.\n` +
                    "해당 사안은 금일 중으로 최종 검토를 완료할 예정이며, 구체적인 조치 사항은 내일 오전 9시에 별도로 안내드리겠습니다. 업무에 불편을 드린 점 사과드립니다.";
            } finally {
                // 8. 버튼 활성화 및 상태 복원
                registerBtn.disabled = false;
                registerBtn.textContent = '변환';
            }
        }

        /**
         * 입력 폼 초기화 함수
         */
        function initializeForm() {
            document.getElementById('topic-input').value = '';
            document.getElementById('content-textarea').value = '';
            document.getElementById('ai-result').textContent = '전문적이고 깔끔하게 다듬어진 메시지가 여기에 표시됩니다.';
            document.getElementById('ai-result').style.color = 'var(--color-text)'; 
        }

        /**
         * 다른 답변 보기 함수 (실제 API 연동 시 재호출 로직으로 변경)
         */
        function showOtherResponse() {
            alert("'다른 답변 보기' 기능이 호출되었습니다.\n(실제 서비스에서는 register() 함수를 재호출하여 AI에게 다른 버전의 응답을 요청합니다.)");
        }

        /**
         * 현재 접속자 수를 업데이트하는 함수 (테스트용)
         */
        function updateCurrentUserCount() {
            const userCountElement = document.getElementById('current-users');
            // 데모를 위해 고정/랜덤 값을 사용
            const demoCount = Math.floor(Math.random() * 80) + 20; 
            userCountElement.textContent = demoCount;
        }

        // 페이지 로드 시 접속자 수 초기화
        document.addEventListener('DOMContentLoaded', updateCurrentUserCount);
    </script>
</body>

</html>






